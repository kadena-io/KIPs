---
KIP: '0037'
Title: kadena_getAccount_v1 API
Author: Danillo Felixdaal and Bart Huijgen
Status: Draft
Type: Standard
Category: Interface
Created: 2025-02-17
---

# kadena_getAccount_v1 API

## Abstract

This KIP standardizes the `kadena_getAccount_v1` method to allow retrieval of a specific account from a Kadena wallet by passing a public key and fungible contract. This enables dApps to request an account for a particular public key and contract combination when multiple accounts may exist within the wallet.

## Motivation

While `kadena_getActiveAccount_v1` returns the currently selected account, there are scenarios where a dApp may require a specific account based on a public key and fungible contract combination. For example, a dApp might allow the user to select an account for a particular fungible contract if the wallet holds multiple account configurations. This method provides a standardized way to fetch that specific account directly from the wallet.

## Specification

### Method Definition

**Method Name:** `kadena_getAccount_v1`

### Request Parameters

```typescript
interface GetAccountRequest {
  publicKey?: string // Optional: Public key to identify the account.
  contract?: string // Optional: Fungible contract to specify which account to retrieve.
}
```

> **Note:** If both `publicKey` and `contract` are omitted, implementations MAY default to returning the active account (as per `kadena_getActiveAccount_v1`). However, it is recommended that a specific query is provided when a particular account is needed.

### Response

```typescript
interface AccountInfo {
  accountName: string // The unique identifier for the account.
  fungibleContract: string // Identifier for the fungible token contract.
  chainAccounts?: Array<{
    chainId: string // The chain identifier within the network.
    guard: {
      keys: string[] // Array of public keys (secret keys are omitted for security).
      pred: string // Predicate defining key validation (e.g., "keys-all", "keys-any").
    }
  }>
}
```

> **Note:** The `chainAccounts` field is optional because...

### Error Responses

In case of failure, the wallet **MUST** return an error according to the [JSON-RPC 2.0 specification](https://www.jsonrpc.org/specification#error_object):

```typescript
interface ErrorResponse {
  id: number
  jsonrpc: '2.0'
  error: {
    code: number
    message: string
    data?: object
  }
}
```

#### Conditional Error Handling

- **Insufficient Parameters:**  
  If only one parameter is provided (either `publicKey` or `contract`) and that is insufficient to uniquely identify an account, the wallet **MUST** return a parameter validation error with:

  - **Code:** -32602
  - **Message:** "Invalid parameters: both publicKey and contract must be provided to retrieve a specific account."

- **Account Not Found:**  
  If both `publicKey` and `contract` are provided but no matching account exists in the wallet, the wallet **MUST** return an error with:

  - **Code:** -32008
  - **Message:** "Account not found for the provided publicKey and contract."

- **No Active Account Available:**  
  If no parameters are provided and there is no active account available, the wallet **MUST** return an error with:
  - **Code:** -32008
  - **Message:** "No account information available."

### Error Types

| Code   | Message                          |
| ------ | -------------------------------- |
| -32603 | Internal server error            |
| -32008 | No account information available |

### Behavior Requirements

1. **Account Retrieval:**

   - **MUST** return accurate and up-to-date information for the account identified by the provided `publicKey` and `contract`.

2. **Error Handling:**
   - **MUST** return a clear and specific error if the account cannot be retrieved due to invalid parameters, configuration issues, or if the account is not found.

## Examples

### Retrieve Specific Account from Wallet

#### Request Example

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "kadena_getAccount_v1",
  "params": {
    "publicKey": "60870392901728fe6bb773534d71272d0851b587cb91cb859a303b20f1025069",
    "contract": "coin"
  }
}
```

#### Response Example

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {
    "accountName": "k:60870392901728fe6bb773534d71272d0851b587cb91cb859a303b20f1025069",
    "fungibleContract": "coin",
    "chainAccounts": [
      {
        "chainId": "0",
        "guard": {
          "keys": [
            "60870392901728fe6bb773534d71272d0851b587cb91cb859a303b20f1025069"
          ],
          "pred": "keys-all"
        }
      }
    ]
  }
}
```

### Error Response Example (Account Not Found)

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "error": {
    "code": -32008,
    "message": "Account not found for the provided publicKey and contract"
  }
}
```

### Error Response Example (Insufficient Parameters)

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "error": {
    "code": -32602,
    "message": "Invalid parameters: both publicKey and contract must be provided to retrieve a specific account"
  }
}
```

## Backwards Compatibility

- **Legacy Methods:** Wallets **MAY** support older methods for retrieving account information alongside `kadena_getAccount_v1`. Legacy methods **MUST** be documented as deprecated and phased out over time.

- **Configuration Consistency:** Implementations **MUST** ensure that the returned account information matches the wallet’s stored configuration.

## Security Considerations

- **Data Accuracy:** Ensure that the returned account information is accurate, verified, and reflects the account’s current state.
