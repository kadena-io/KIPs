---
KIP: '0042'
Title: kadena_disconnect_v1 API
Author: Danillo Felixdaal and Bart Huijgen
Status: Draft
Type: Standard
Category: Interface
Created: 2025-02-17
---

# kadena_disconnect_v1 API

## Abstract

This KIP standardizes the `kadena_disconnect_v1` method for terminating connections between decentralized applications (dApps) and Kadena wallets. The method securely ends active sessions, revokes permissions, and clears cached session data, ensuring a predictable and secure disconnection process.

## Motivation

A consistent disconnection method is crucial to protect user data and prevent unauthorized access after a session ends. By standardizing `kadena_disconnect_v1`, we aim to:

- Revoke active sessions and clear cached credentials.
- Ensure that no stale session data remains post-disconnection.
- Provide a uniform interface for disconnecting across wallet implementations.
- Enhance overall security and user experience.

## Specification

### Method Definition

**Method Name:** `kadena_disconnect_v1`

### Request Parameters

```typescript
interface DisconnectRequest {
  // TODO: not sure if networkId makes sense here, ecko uses it.
  networkId?: string
}
```

## Response

The method returns a void type, indicating that the disconnection was successful:

```typescript
type DisconnectResponse = void
```

### Error Responses

In case of failure, the wallet MUST return an error according to the [jsonrpc spec](https://www.jsonrpc.org/specification#error_object) which represent the following type:

```typescript
interface ErrorResponse {
  id: number
  jsonrpc: '2.0'
  error: {
    code: number
    message: string
    data?: object
  }
}
```

### Error types

| Code   | Message               |
| ------ | --------------------- |
| -32603 | Internal server error |

## Behavior Requirements

1. Session Termination:

   - MUST revoke any active session and clear all cached credentials or tokens.
   - MUST ensure the wallet no longer considers the account as connected after disconnection.

2. Network Handling:

   - MUST disconnect the session corresponding to the network.

3. Event Emission:

   - SHOULD emit a kadena_onAccountChanged_v1 event with null to notify listeners of the disconnection.
   - SHOULD emit a kadena_onNetworkChanged_v1 event with null to notify listeners of the disconnection.
   - SHOULD emit a kadena_onDisconnect_v1 event to notify listeners of the disconnection.

4. Security Considerations:
   - MUST securely clear all session-related data from memory to prevent unauthorized access.
   - MUST verify the origin of disconnection requests to avoid malicious terminations.

# Examples

## Basic Disconnect Request

### Request

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "kadena_disconnect_v1",
  "params": {}
}
```

### Success Response

An empty response indicates that the disconnection was successful.

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {}
}
```

## Error Response Example

### Error Response

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "error": {
    "code": -32603,
    "msg": "Internal server error"
  }
}
```

## Backwards Compatibility

- Legacy Methods: Wallets MAY support older disconnect methods alongside kadena_disconnect_v1. Legacy methods MUST be documented as deprecated and phased out over time.
- Session Cleanup: All active sessions MUST be cleared following a successful disconnection.

## Security Considerations

- Data Clearance: Ensure that session tokens or credentials are securely removed from memory post-disconnection.
- Event Notification: Emit clear events to notify dApps of the disconnection, minimizing the risk of stale session data.
