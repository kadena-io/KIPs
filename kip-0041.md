---
KIP: '0041'
Title: kadena_connect_v1 API
Author: Danillo Felixdaal and Bart Huijgen
Status: Draft
Type: Standard
Category: Interface
Created: 2025-02-17
---

# kadena_connect_v1 API

## Abstract

This KIP standardizes the `kadena_connect_v1` method for establishing a connection between decentralized applications (dApps) and Kadena wallets. The method handles user authorization and returns active account information, providing a consistent interface for wallet connectivity across the Kadena ecosystem.

## Motivation

Inconsistent connection methods across various wallet implementations lead to fragmented user experiences and increased integration complexity for dApps. Standardizing `kadena_connect_v1` will:

- Unify connection workflows across all Kadena wallets.
- Simplify dApp integration with predictable method signatures.
- Enable silent reconnection for returning users.
- Provide clear error reporting for connection failures.

## Specification

### Method Definition

**Method Name:** `kadena_connect_v1`

### Request Parameters

```typescript
interface ConnectRequest {
  silent?: boolean // Optional: Attempt silent authentication without UI prompts.
  networkId: string // Required: Network ID (e.g., "mainnet01", "testnet04")
}
```

### Response

The method returns an AccountInfo object containing the connected account’s details:

```typescript
interface AccountInfo {
  accountName: string // Unique account identifier.
  fungibleContract: string // Identifier for the fungible token contract.
  chainAccounts?: Array<{
    chainId: string // Chain identifier within the network.
    guard: {
      keys: Array<{ publicKey: string }> // Array of public keys (secret keys omitted for security).
      pred: string // Predicate defining key validation (e.g., "keys-all", "keys-any").
    }
  }>
}
```

### Error Responses

In case of failure, the wallet MUST return an error according to the [jsonrpc spec](https://www.jsonrpc.org/specification#error_object) which represent the following type:

```typescript
interface ErrorResponse {
  id: number
  jsonrpc: '2.0'
  error: {
    code: number
    message: string
    data?: object
  }
}
```

### Error types

| Code   | Message                              |
| ------ | ------------------------------------ |
| -32002 | Resource unavailable                 |
| -32004 | Requested network does not exist     |
| -32005 | Could not return account information |
| -32602 | Invalid method parameter(s)          |
| -32603 | Internal server error                |

### Behavior Requirements

1. User Consent:
   - MUST display connection details unless silent: true and prior consent exists.
   - MUST persist consent only after explicit user approval.
2. Network Handling:
   - MUST validate the provided networkId against supported networks.
   - MUST return a networkUnsupported error if the network is invalid.
3. Cryptographic Safety:
   - MUST NOT expose secret keys.
   - MUST return public keys in a secure, standardized format.

# Examples

## Basic Connection Request

### Request

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "kadena_connect_v1",
  "params": {
    "networkId": "mainnet01"
  }
}
```

### Success Response

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "result": {
    "accountName": "k:abc123...",
    "fungibleContract": "ft:xyz456...",
    "chainAccounts": [
      {
        "chainId": "0",
        "guard": {
          "keys": [
            {
              "publicKey": "ae18efd16cbd49e9a92552a2589ac01491b486fbcbb1e3f07980f945597e2033"
            }
          ],
          "pred": "keys-all"
        }
      }
    ]
  }
}
```

## Silent Reconnection Attempt

### Request

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "method": "kadena_connect_v1",
  "params": {
    "silent": true,
    "networkId": "testnet04"
  }
}
```

### Error Response

```json
{
  "id": 1,
  "jsonrpc": "2.0",
  "error": {
    "code": -32004,
    "message": "URequested network does not exist"
  }
}
```

### Backwards Compatibility

- Legacy Methods: Wallets MAY support deprecated connection methods alongside kadena_connect_v1. Legacy methods MUST be documented as deprecated and phased out over time.
- Network Fallback: Implementations MUST handle unsupported or invalid networkId values by returning an appropriate error.

### Security Considerations

- Silent Mode Safeguards: Wallets MUST implement session expiration for silent reconnections. Automatic reconnections MUST require prior explicit consent.
- Phishing Protection: Wallets MUST display the requesting dApp’s domain during the initial connection and validate TLS certificates in web-based environments.
